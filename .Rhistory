mod12 <- lme(log(OC_Per) ~ 1 + Elevation, data = DF, random = ~1 | Site/Core.Number, method="REML")
mod13 <- lme(log(OC_Per) ~ 1 + Coast + Type + Percent.Silt.Fraction + Corrected_DBD_g_cm3 + Elevation, data = DF, random = ~1 | Site/Core.Number, method="REML")
mod14 <- lme(log(OC_Per) ~ 1 + Coast + Type + Elevation, data = DF, random = ~1 | Site/Core.Number, method="REML")
mod15 <- lme(log(OC_Per) ~ 1 + log(REI_Raw), data = DF, random = ~1 | Site/Core.Number, method="REML")
mod16 <- lme(log(OC_Per) ~ 1 + Coast + Type + log(REI_Raw), data = DF, random = ~1 | Site/Core.Number, method= "REML")
mod17 <- lme(log(OC_Per) ~ 1 + Type + Coast + log(REI_Raw) + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method="REML")
mod18 <- lme(log(OC_Per) ~ 1 + log(REI_Raw) + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method="REML")
mod19 <- lme(log(OC_Per) ~ 1 + log(REI_Raw)*Elevation, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod20 <- lme(log(OC_Per) ~ 1, data = DF, random = ~ 1 | Site/Core.Number method="REML" )
mod20 <- lme(log(OC_Per) ~ 1, data = DF, random = ~ 1 | Site/Core.Number,  method="REML" )
model.sel(mod1,mod2,mod3, mod4, mod5, mod6, mod7, mod8, mod9, mod10, mod11, mod12, mod13, mod14, mod15, mod16, mod17, mod18,mod19, mod20)
summary(mod17)
hist(DF$REI_Raw)
hist(log(DF$REI_Raw))
names(DF)
hist(REI_scales)
hist(REI_Scaled)
hist(DF$REI_Scaled)
#Testing all parameters
mod1 <- lme(log(OC_Per) ~1 + log(REI_Raw) + Elevation + Watercourse_NEAR_DIST.x + coast + Type + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
#Testing all parameters
mod1 <- lme(log(OC_Per) ~1 + log(REI_Raw) + Elevation + Watercourse_NEAR_DIST.x + Coast + Type + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
plot(DF$Elevation ~ DF$Site)
plot(DF$Site ~ DF$Elevation)
levels(as.factor(DF$Site))
levels(as.factor(DF$Elevation))
plot(DF$Elevation,DF$Site)
plot(DF$Elevation, as.factor(DF$Site))
plot(as.factor(DF$Site), DF$Elevation)
plot(as.factor(DF$Site), DF$Elevation)
DF$intertidal <- ifelse(DF$Elevation > "0", "intertidal", "subtidal")
#Testing all parameters
mod1 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + Watercourse_NEAR_DIST.x + Coast + Type + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
hist(DF$Watercourse_NEAR_DIST.x)
hist(log(DF$Watercourse_NEAR_DIST.x))
#Testing all parameters
mod1 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Type + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
## all site level predictors
mod2 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x) + Coast, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod3 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod4 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x)*Type + Coast, data = DF, random = ~1 | Site/Core.Number, method = "REML")
#Testing all parameters
mod1 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod1a <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
## all site level predictors
mod2 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x) + Coast, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod3 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod4 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x)*Type + Coast, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod5 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod6 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod7 <- lme(log(OC_Per) ~1 + log(REI_Raw), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod8 <- lme(log(OC_Per) ~1 + intertidal, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod9 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod10 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod11 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod12 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod13 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_Midpoint_cm_rounded, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod14 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod15 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod16 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod17 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod18 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod19 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod20 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod21 <- lme(log(OC_Per) ~1 + log(REI_Raw) + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod22 <- lme(log(OC_Per) ~1 + log(REI_Raw) + log(Watercourse_NEAR_DIST.x) + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
model.sel(mod1,mod1a, mod2,mod3, mod4, mod5, mod6, mod7, mod8, mod9, mod10, mod11, mod12, mod13, mod14, mod15, mod16, mod17, mod18,mod19, mod20, mod21, mod22)
mod12a <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + log(Watercourse_NEAR_DIST.x) + Coast + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
model.sel(mod1,mod1a, mod2,mod3, mod4, mod5, mod6, mod7, mod8, mod9, mod10, mod11, mod12, mod12a, mod13, mod14, mod15, mod16, mod17, mod18,mod19, mod20, mod21, mod22)
mod12b <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + log(Watercourse_NEAR_DIST.x) + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
model.sel(mod1,mod1a, mod2,mod3, mod4, mod5, mod6, mod7, mod8, mod9, mod10, mod11, mod12, mod12a, mod12b, mod13, mod14, mod15, mod16, mod17, mod18,mod19, mod20, mod21, mod22)
mod12c <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + log(Watercourse_NEAR_DIST.x) + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
model.sel(mod1,mod1a, mod2,mod3, mod4, mod5, mod6, mod7, mod8, mod9, mod10, mod11, mod12, mod12a, mod12b, mod12c, mod13, mod14, mod15, mod16, mod17, mod18,mod19, mod20, mod21, mod22)
mod12d <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + log(Watercourse_NEAR_DIST.x)  + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
model.sel(mod1,mod1a, mod2,mod3, mod4, mod5, mod6, mod7, mod8, mod9, mod10, mod11, mod12, mod12a, mod12b, mod12c, mod12d, mod13, mod14, mod15, mod16, mod17, mod18,mod19, mod20, mod21, mod22)
mod12d <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + log(Watercourse_NEAR_DIST.x)  + Corrected_Midpoint_cm_rounded, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod12d <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + log(Watercourse_NEAR_DIST.x)  + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod12e <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + log(Watercourse_NEAR_DIST.x)  + Corrected_Midpoint_cm_rounded, data = DF, random = ~1 | Site/Core.Number, method = "REML")
model.sel(mod1,mod1a, mod2,mod3, mod4, mod5, mod6, mod7, mod8, mod9, mod10, mod11, mod12, mod12a, mod12b, mod12c, mod12d, mod12e, mod13, mod14, mod15, mod16, mod17, mod18,mod19, mod20, mod21, mod22)
summary(mod12a)
hist(DF$Percent.Gravel.Fraction)
hist(DF$Percent.Sand.Fraction)
hist(DF$Percent.Silt.Fraction)
hist(log(DF$Percent.Silt.Fraction))
## Mary's working with the files
## packages
library(tidyverse)
library(nlme)
library(MuMIn)
#Read in data ----
DF <- read.csv(file = "WongChristensenDataforModellingOct19.csv")
DF$intertidal <- ifelse(DF$Elevation > "0", "intertidal", "subtidal")
#Testing all parameters
mod1 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod1a <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
## all site level predictors
mod2 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x) + Coast, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod3 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod4 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x)*Type + Coast, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod5 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod6 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod7 <- lme(log(OC_Per) ~1 + log(REI_Raw), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod8 <- lme(log(OC_Per) ~1 + intertidal, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod9 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod10 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod11 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod12 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod12a <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + log(Watercourse_NEAR_DIST.x) + Coast + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod12b <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + log(Watercourse_NEAR_DIST.x) + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod12c <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + log(Watercourse_NEAR_DIST.x) + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod12d <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + log(Watercourse_NEAR_DIST.x)  + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod12e <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + log(Watercourse_NEAR_DIST.x)  + Corrected_Midpoint_cm_rounded, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod13 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_Midpoint_cm_rounded, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod14 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod15 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod16 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod17 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod18 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod0 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod1 <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
## all site level predictors
mod2 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x) + Coast, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod3 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod4 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x)*Type + Coast, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod5 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod6 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod7 <- lme(log(OC_Per) ~1 + log(REI_Raw), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod8 <- lme(log(OC_Per) ~1 + intertidal, data = DF, random = ~1 | Site/Core.Number, method = "REML")
## all site + core level predictors
mod9 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod10 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod11 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod12 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod13 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + log(Watercourse_NEAR_DIST.x) + Coast + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod12b <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + log(Watercourse_NEAR_DIST.x) + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod14 <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + log(Watercourse_NEAR_DIST.x) + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod15 <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + log(Watercourse_NEAR_DIST.x)  + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod16 <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + log(Watercourse_NEAR_DIST.x)  + Corrected_Midpoint_cm_rounded, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod17 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_Midpoint_cm_rounded, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod18 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod19 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod20 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod21 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod22 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod23 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod24 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod25 <- lme(log(OC_Per) ~1 + log(REI_Raw) + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod26 <- lme(log(OC_Per) ~1 + log(REI_Raw) + log(Watercourse_NEAR_DIST.x) + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
model.sel(mod0,mod1, mod2,mod3, mod4, mod5, mod6, mod7, mod8, mod9, mod10, mod11, mod12, mod13, mod14, mod15, mod16, mod17, mod18, mod19, mod20, mod21, mod22, mod23, mod24, mod25)
mod27 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + log(Watercourse_NEAR_DIST.x) + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
model.sel(mod0,mod1, mod2,mod3, mod4, mod5, mod6, mod7, mod8, mod9, mod10, mod11, mod12, mod13, mod14, mod15, mod16, mod17, mod18, mod19, mod20, mod21, mod22, mod23, mod24, mod25, mod26, mod27)
mod28 <- lme(log(OC_Per) ~1 + Type + log(Watercourse_NEAR_DIST.x) + Coast + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
model.sel(mod0,mod1, mod2,mod3, mod4, mod5, mod6, mod7, mod8, mod9, mod10, mod11, mod12, mod13, mod14, mod15, mod16, mod17, mod18, mod19, mod20, mod21, mod22, mod23, mod24, mod25, mod26, mod27, mod28)
mod29 <- lme(log(OC_Per) ~1 + Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
model.sel(mod0,mod1, mod2,mod3, mod4, mod5, mod6, mod7, mod8, mod9, mod10, mod11, mod12, mod13, mod14, mod15, mod16, mod17, mod18, mod19, mod20, mod21, mod22, mod23, mod24, mod25, mod26, mod27, mod28, mod29)
mod28 <- lme(log(OC_Per) ~1 + Type + Coast + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod30 <- lme(log(OC_Per) ~1 + Type + Coast + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod28 <- lme(log(OC_Per) ~1 + Type + log(Watercourse_NEAR_DIST.x) + Coast + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
model.sel(mod0,mod1, mod2,mod3, mod4, mod5, mod6, mod7, mod8, mod9, mod10, mod11, mod12, mod13, mod14, mod15, mod16, mod17, mod18, mod19, mod20, mod21, mod22, mod23, mod24, mod25, mod26, mod27, mod28, mod29, mod30)
mod31 <- lme(log(OC_Per) ~1 + Type*log(Watercourse_NEAR_DIST.x) + Coast + Percent.Silt.Fraction, data = DF, random = ~1 | Site/Core.Number, method = "REML")
model.sel(mod0,mod1, mod2,mod3, mod4, mod5, mod6, mod7, mod8, mod9, mod10, mod11, mod12, mod13, mod14, mod15, mod16, mod17, mod18, mod19, mod20, mod21, mod22, mod23, mod24, mod25, mod26, mod27, mod28, mod29, mod30, mod31)
summary(mod30)
coefs(mod30)
coef(mod30)
fixef(mod30)
exp(mod30$Intercept)
exp(fixef(mod30)$Intercept)
exp(fixef(mod30)[,1])
exp(fixef(mod30)[1])
min(DF$Percent.Silt.Fraction)
hist(DF$Percent.Silt.Fraction)
hist((DF$Percent.Silt.Fraction)^2)
hist(sqrt(DF$Percent.Silt.Fraction))
#Testing all parameters
mod0 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + log(log(Percent.Silt.Fraction)), data = DF, random = ~1 | Site/Core.Number, method = "REML")
#Testing all parameters
mod0 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
#Testing all parameters
mod0 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod1 <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
## all site level predictors
mod2 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x) + Coast, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod3 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod4 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x)*Type + Coast, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod5 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod6 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod7 <- lme(log(OC_Per) ~1 + log(REI_Raw), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod8 <- lme(log(OC_Per) ~1 + intertidal, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod9 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod10 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod11 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod12 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + log(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod12 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod13 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + log(Watercourse_NEAR_DIST.x) + Coast + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod28 <- lme(log(OC_Per) ~1 + Type + log(Watercourse_NEAR_DIST.x) + Coast + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod29 <- lme(log(OC_Per) ~1 + Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod30 <- lme(log(OC_Per) ~1 + Type + Coast + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod31 <- lme(log(OC_Per) ~1 + Type*log(Watercourse_NEAR_DIST.x) + Coast + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod27 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + log(Watercourse_NEAR_DIST.x) + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod14 <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + log(Watercourse_NEAR_DIST.x) + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod15 <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + log(Watercourse_NEAR_DIST.x)  + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod16 <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + log(Watercourse_NEAR_DIST.x)  + Corrected_Midpoint_cm_rounded, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod17 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_Midpoint_cm_rounded, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod18 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod19 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod20 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod21 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod22 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod23 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_DBD_g_cm3 + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod24 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod25 <- lme(log(OC_Per) ~1 + log(REI_Raw) + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod26 <- lme(log(OC_Per) ~1 + log(REI_Raw) + log(Watercourse_NEAR_DIST.x) + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
hist(DF$Corrected_DBD_g_cm3)
hist(log(DF$Corrected_DBD_g_cm3))
log(Corrected_DBD_g_cm3)
mod23 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + log(Corrected_DBD_g_cm3) + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod22 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + log(Corrected_DBD_g_cm3) + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod21 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Corrected_DBD_g_cm3) + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod20 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + log(Corrected_DBD_g_cm3) + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod19 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + Coast + log(Corrected_DBD_g_cm3) + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod18 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + log(Corrected_DBD_g_cm3), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod29 <- lme(log(OC_Per) ~1 + Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + log(Corrected_DBD_g_cm3) + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod10 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + log(Corrected_DBD_g_cm3) + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod9 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + log(Corrected_DBD_g_cm3) + Corrected_Midpoint_cm_rounded, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod1 <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + log(Corrected_DBD_g_cm3) + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
model.sel(mod0,mod1, mod2,mod3, mod4, mod5, mod6, mod7, mod8, mod9, mod10, mod11, mod12, mod13, mod14, mod15, mod16, mod17, mod18, mod19, mod20, mod21, mod22, mod23, mod24, mod25, mod26, mod27, mod28, mod29, mod30, mod31)
#Testing all parameters
mod0 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + log(Corrected_DBD_g_cm3) + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
model.sel(mod0,mod1, mod2,mod3, mod4, mod5, mod6, mod7, mod8, mod9, mod10, mod11, mod12, mod13, mod14, mod15, mod16, mod17, mod18, mod19, mod20, mod21, mod22, mod23, mod24, mod25, mod26, mod27, mod28, mod29, mod30, mod31)
summary(mod30)
summary(mod13)
#Testing all parameters
mod0 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + log(Corrected_DBD_g_cm3) + Corrected_Midpoint_cm_rounded + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod1 <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + log(Corrected_DBD_g_cm3) + Corrected_Midpoint_cm_rounded + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
## all site level predictors
mod2 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x) + Coast, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod3 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod4 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x)*Type + Coast, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod5 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod6 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod7 <- lme(log(OC_Per) ~1 + log(REI_Raw), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod8 <- lme(log(OC_Per) ~1 + intertidal, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod9 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + log(Corrected_DBD_g_cm3) + Corrected_Midpoint_cm_rounded, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod10 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + log(Corrected_DBD_g_cm3) + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod11 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_Midpoint_cm_rounded + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod12 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod13 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + log(Watercourse_NEAR_DIST.x) + Coast + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod28 <- lme(log(OC_Per) ~1 + Type + log(Watercourse_NEAR_DIST.x) + Coast + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod29 <- lme(log(OC_Per) ~1 + Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + log(Corrected_DBD_g_cm3) + Corrected_Midpoint_cm_rounded + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod30 <- lme(log(OC_Per) ~1 + Type + Coast + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod31 <- lme(log(OC_Per) ~1 + Type*log(Watercourse_NEAR_DIST.x) + Coast + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod27 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + log(Watercourse_NEAR_DIST.x) + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod14 <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + log(Watercourse_NEAR_DIST.x) + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod15 <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + log(Watercourse_NEAR_DIST.x)  + Corrected_Midpoint_cm_rounded + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod16 <- lme(log(OC_Per) ~1 + log(REI_Raw) + Type + log(Watercourse_NEAR_DIST.x)  + Corrected_Midpoint_cm_rounded, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod17 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_Midpoint_cm_rounded, data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod18 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + log(Corrected_DBD_g_cm3), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod19 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + Coast + log(Corrected_DBD_g_cm3) + Corrected_Midpoint_cm_rounded + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod20 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + log(Corrected_DBD_g_cm3) + Corrected_Midpoint_cm_rounded + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod21 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Corrected_DBD_g_cm3) + Corrected_Midpoint_cm_rounded + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod22 <- lme(log(OC_Per) ~1 + log(REI_Raw)*Type + log(Corrected_DBD_g_cm3) + Corrected_Midpoint_cm_rounded + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod23 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + log(Corrected_DBD_g_cm3) + Corrected_Midpoint_cm_rounded + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod24 <- lme(log(OC_Per) ~1 + log(REI_Raw) + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_Midpoint_cm_rounded + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod25 <- lme(log(OC_Per) ~1 + log(REI_Raw) + log(Watercourse_NEAR_DIST.x) + Coast + Corrected_Midpoint_cm_rounded + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod26 <- lme(log(OC_Per) ~1 + log(REI_Raw) + log(Watercourse_NEAR_DIST.x) + Corrected_Midpoint_cm_rounded + log(Percent.Silt.Fraction+0.01), data = DF, random = ~1 | Site/Core.Number, method = "REML")
model.sel(mod0,mod1, mod2,mod3, mod4, mod5, mod6, mod7, mod8, mod9, mod10, mod11, mod12, mod13, mod14, mod15, mod16, mod17, mod18, mod19, mod20, mod21, mod22, mod23, mod24, mod25, mod26, mod27, mod28, mod29, mod30, mod31)
mod26 <- lme(log(OC_Per) ~1 + log(REI_Raw) + log(Watercourse_NEAR_DIST.x) + Corrected_Midpoint_cm_rounded + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
model.sel(mod0,mod1, mod2,mod3, mod4, mod5, mod6, mod7, mod8, mod9, mod10, mod11, mod12, mod13, mod14, mod15, mod16, mod17, mod18, mod19, mod20, mod21, mod22, mod23, mod24, mod25, mod26, mod27, mod28, mod29, mod30, mod31)
hist(sqrt(DF$Percent.Silt.Fraction))
model.sel(mod0,mod1, mod2,mod3, mod4, mod5, mod6, mod7, mod8, mod9, mod10, mod11, mod12, mod13, mod14, mod15, mod16, mod17, mod18, mod19, mod20, mod21, mod22, mod23, mod24, mod25, mod26, mod27, mod28, mod29, mod30, mod31)
summary(mod30)
exp(fixef(mod30)[1])
fixef(mod30)
exp(fixef(mod30)[2])
exp(fixef(mod30)[2]) + exp(fixef(mod30)[1])
exp(fixef(mod30)[1]) + exp(fixef(mod30)[3])
exp(fixef(mod30)[1])
exp(fixef(mod30)[3])
exp(fixef(mod30)[1]) + exp(fixef(mod30)[4])
library(car)
vif_values <- vif(mod0)
mod0 <- lm(log(OC_Per) ~1 + log(REI_Raw)*Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + log(Corrected_DBD_g_cm3) + Corrected_Midpoint_cm_rounded + sqrt(Percent.Silt.Fraction), data = DF)
vif_values <- vif(mod0)
mod0 <- lm(log(OC_Per) ~1 + log(REI_Raw) + Type + intertidal + log(Watercourse_NEAR_DIST.x) + Coast + log(Corrected_DBD_g_cm3) + Corrected_Midpoint_cm_rounded + sqrt(Percent.Silt.Fraction), data = DF)
vif_values <- vif(mod0)
barplot(vif_falues)
barplot(vif_ alues)
barplot(vif_values)
vif_values
cor_data <- DF[,c("log(REI_Raw)", "Type", "intertidal", "log(Watercourse_NEAR_DIST.x", "Coast", "log(Corrected_DBD_g_cm3)", "Corrected_Midpoint_cm_rounded", "sqrt(Percent.Silt.Fraction)"]
cor_data <- DF[,c("log(REI_Raw)", "Type", "intertidal", "log(Watercourse_NEAR_DIST.x", "Coast", "log(Corrected_DBD_g_cm3)", "Corrected_Midpoint_cm_rounded", "sqrt(Percent.Silt.Fraction)")]
cor_data <- DF[, c("log(REI_Raw)", "Type", "intertidal", "log(Watercourse_NEAR_DIST.x", "Coast", "Corrected_DBD_g_cm3", "Corrected_Midpoint_cm_rounded", "Percent.Silt.Fraction")]
cor_data <- DF[, c("log(REI_Raw)", "Type", "intertidal", "Watercourse_NEAR_DIST.x", "Coast", "Corrected_DBD_g_cm3", "Corrected_Midpoint_cm_rounded", "Percent.Silt.Fraction")]
cor_data <- DF[, c("REI_Raw", "Type", "intertidal", "Watercourse_NEAR_DIST.x", "Coast", "Corrected_DBD_g_cm3", "Corrected_Midpoint_cm_rounded", "Percent.Silt.Fraction")]
cor(cor_data)
cor_data <- DF[, c("REI_Raw", "Watercourse_NEAR_DIST.x", "Coast", "Corrected_DBD_g_cm3", "Corrected_Midpoint_cm_rounded", "Percent.Silt.Fraction")]
cor(cor_data)
cor_data <- DF[, c("REI_Raw", "Watercourse_NEAR_DIST.x", "Corrected_DBD_g_cm3", "Corrected_Midpoint_cm_rounded", "Percent.Silt.Fraction")]
cor(cor_data)
plot(DF$Percent.Silt.Fraction ~ DF$Coast)
plot(DF$Coast ~ DF$Percent.Silt.Fraction
)
plot(DF$Coast, DF$Percent.Silt.Fraction)
levels(DF$Coast)
levels(as.factor(DF$Coast))
range(DF$Percent.Silt.Fraction)
class(DF$Percent.Silt.Fraction)
plot(as.factor(DF$Coast), DF$Percent.Silt.Fraction)
)
plot(as.factor(DF$Coast), DF$DBD))
plot(as.factor(DF$Coast), DF$DBD)
class(DF$Corrected_DBD_g_cm3)
plot(as.factor(DF$Coast), DF$Corrected_DBD_g_cm3)
plot(as.factor(DF$Coast), DF$Watercourse_NEAR_DIST.x)
mod31 <- lme(log(OC_Per) ~1 + Type + log(Corrected_DBD_g_cm3) + log(Watercourse_NEAR_DIST.x) + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod32 <- lme(log(OC_Per) ~1 + Type + log(Corrected_DBD_g_cm3) + log(Watercourse_NEAR_DIST.x) + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
mod31 <- lme(log(OC_Per) ~1 + Type*log(Watercourse_NEAR_DIST.x) + Coast + sqrt(Percent.Silt.Fraction), data = DF, random = ~1 | Site/Core.Number, method = "REML")
model.sel(mod0,mod1, mod2,mod3, mod4, mod5, mod6, mod7, mod8, mod9, mod10, mod11, mod12, mod13, mod14, mod15, mod16, mod17, mod18, mod19, mod20, mod21, mod22, mod23, mod24, mod25, mod26, mod27, mod28, mod29, mod30, mod31, mod32)
names(DF)
names(DF20)
DF20 <- read.csv(file = "BlueCarbonData_1.csv")
names(DF20)
plot(as.factor(DF$Coast), DF$Corrected_DBD_g_cm3)
plot(as.factor(DF$Coast), DF$Percent.Silt.Fraction)
plot(as.factor(DF$Coast), DF$Watercourse_NEAR_DIST.x)
#Read in data ----
DF <- read.csv(file = "WongChristensenDataforModellingOct19.csv")
DF_LOI <- read.csv(file = "BlueCarbonData_1.csv")
names(DF)
names(DF_LOI)
## Mary's working with the files
## packages
library(tidyverse)
library(nlme)
library(MuMIn)
library(car)
library(ggplot2)
#Read in data ----
DF <- read.csv(file = "WongChristensenDataforModellingOct19.csv")
DF_LOI <- read.csv(file = "BlueCarbonData_1.csv")
CF <- read.csv(file = "compaction.csv")
#DF$intertidal <- ifelse(DF$Elevation > "0", "intertidal", "subtidal")
#DF$Coast_no <- DF[, DF$Coast == "Atlantic"]
DF$c_dens <- DF$OC_Per*DF$Corrected_DBD_g_cm3 # C (g / cm3)
DF$Site <- factor(DF$Site)
DF$Type <- factor(DF$Type)
DF$estCfactorS <- ifelse(DF$Extracted_IntervalStart_Depth_c != "0",  DF$Extracted_IntervalStart_Depth_cm/DF$Corrected_IntervalStart_Depth_cm, "0")
# create a datafile mean and sd est conversion factors to identify possible errors
DF_cores <- DF %>%
group_by(SiteCode, Core.Number) %>%
filter(estCfactorS != "0") %>%
summarise(meanCF = mean(as.numeric(as.character(estCfactorS))), sdCF = sd(estCfactorS))
## replacing values for correction factors:
DF_test <- DF %>%
mutate(estCfactorS = as.numeric(estCfactorS)) %>%
mutate(estCfactorS = replace(estCfactorS, estCfactorS == 0.18018018018018, 0.869565217391304))
DF_cores <- DF_test %>%
group_by(SiteCode, Core.Number) %>%
filter(estCfactorS != "0") %>%
mutate(as.numeric(as.character(estCfactorS))) %>%
summarise(meanCF = mean(estCfactorS), sdCF = sd(estCfactorS))
DF2 <- DF %>%
left_join(DF_cores)
plot(DF2$meanCF, DF2$estCfactorS)
## having identified problems, we found the original datasheets. bring in Melisa's compaction data and merge
CF2 <- CF %>%
select(-c(CoreName_2, X, sample, compression))
DFc <- DF2 %>%
left_join(CF2)
DFc2 <- DFc %>%
mutate(estCfactorS = as.numeric(estCfactorS)) %>%
mutate(conversion = ifelse(is.na(conversion), "Missing", conversion)) %>%
mutate(meanCF = ifelse(is.na(meanCF), "25", meanCF)) %>%
mutate(CF_final = as.numeric(ifelse(conversion == "Missing", meanCF, conversion))) %>%
mutate(CF_final = ifelse(meanCF == "25", estCfactorS, CF_final))
## create new corrected values
DF3 <- DFc2 %>%
mutate(corr_SD = Extracted_IntervalStart_Depth_cm * CF_final) %>%
mutate(corr_ED = Extracted_IntervalEnd_Depth_cm * CF_final) %>%
mutate(corr_thickness = corr_ED - corr_SD) %>%
mutate(corr_segment_midpoint = (corr_ED + corr_SD)/2) %>%
mutate(c_stock = c_dens * corr_thickness) %>% #C (g / cm2)
select(!c(Elevation, X.y, REI_Scaled, Watercourse_NEAR_DIST.y, Corrected_Midpoint_cm_rounded, Corrected_IntervalStart_Depth_cm, Corrected_IntervalEnd_Depth_cm)) %>%
filter(X.1 != "142") %>%
filter(X.1 != "429") #duplicated rows
mod18 <- lme(log(c_dens) ~1 + log(REI_Raw) + Type + log(Watercourse_NEAR_DIST.x) + sqrt(Percent.Silt.Fraction), data = DF3, random = ~corr_segment_midpoint | Site/CoreName_2, method = "REML")
#figuring it out
new_data <- data.frame(CoreName_2 = rep(unique(DF3$CoreName_2), each = 5), corr_segment_midpoint = rep(c("5", "25", "30", "60", "100"), times = 84))
Site_info <- DF3 %>%
group_by(Site, CoreName_2, REI_Raw, Type, Watercourse_NEAR_DIST.x) %>%
summarise(mud = mean(Percent.Silt.Fraction))
new_data2 <- new_data %>%
left_join(Site_info) %>%
rename(Percent.Silt.Fraction = mud) %>%
mutate(corr_segment_midpoint = as.numeric(corr_segment_midpoint))
predicted_vals <- predict(mod18, new_data2, level = 0:2)
pred_vals <- predicted_vals %>%
separate(CoreName_2, into = c("Site", "CoreName_2"),
sep ="/") %>%
mutate(corr_segment_midpoint = as.numeric(rep(c("5", "25", "30", "60", "100"), times = 84)))
new_data3 <- new_data2 %>%
left_join(pred_vals)
# predicting new values - do it for each cm 1-100
new_data4 <- data.frame(CoreName_2 = rep(unique(DF3$CoreName_2), each = 100), corr_segment_midpoint = rep(c(1:100), times = 84))
new_data5 <- new_data4 %>%
left_join(Site_info) %>%
rename(Percent.Silt.Fraction = mud) %>%
mutate(corr_segment_midpoint = as.numeric(corr_segment_midpoint))
predicted_vals <- predict(mod18, new_data5, level = 0:2)
pred_vals <- predicted_vals %>%
separate(CoreName_2, into = c("Site", "CoreName_2"),
sep ="/") %>%
mutate(corr_segment_midpoint = rep(c(1:100), times = 84)) %>%
mutate(c_dens = exp(predict.CoreName_2))
new_data6 <- new_data5 %>%
left_join(pred_vals) %>%
group_by(Site, CoreName_2, REI_Raw, Type, Watercourse_NEAR_DIST.x) %>%
mutate(c_60a = ifelse(corr_segment_midpoint < 61, c_dens, 0)) %>%
mutate(c_25a = ifelse(corr_segment_midpoint < 26, c_dens, 0)) %>%
summarise_at(., c("c_dens", "c_60a", "c_25a"), sum)
## checking
data7 <- DF3 %>%
left_join(new_data6)
dim(DF3)
dim(data7)
## checking
data7 <- DF3 %>%
full_join(new_data6)
dim(data7)
names(data7)
View(data7)
## checking
data7 <- DF3 %>%
select(Site, CoreName_2, corr_segment_midpoint, c_dens) %>%
pivot_wider(names_from = corr_segment_midpoint, values_from = c_dens)
data7 <- DF3 %>%
select(Site, CoreName_2, corr_segment_midpoint, c_dens)
## checking
data7 <- DF3 %>%
select(Site, CoreName_2, corr_segment_midpoint, c_dens) %>%
pivot_wider(names_from = corr_segment_midpoint, values_from = c_dens)
## checking
data7 <- DF3 %>%
select(Site, CoreName_2, corr_segment_midpoint, c_dens) %>%
pivot_wider(names_from = round(corr_segment_midpoint, 1), values_from = c_dens)
## checking
data7 <- DF3 %>%
select(Site, CoreName_2, corr_segment_midpoint, c_dens) %>%
mutate(depth = round(corr_segment_midpoing, 1)) %>%
pivot_wider(names_from = depth, values_from = c_dens)
## checking
data7 <- DF3 %>%
select(Site, CoreName_2, corr_segment_midpoint, c_dens) %>%
mutate(depth = round(corr_segment_midpoint, 1)) %>%
pivot_wider(names_from = depth, values_from = c_dens)
## checking
data7 <- DF3 %>%
select(Site, CoreName_2, corr_segment_midpoint, c_dens) %>%
mutate(depth = round(corr_segment_midpoint, 0)) %>%
pivot_wider(names_from = depth, values_from = c_dens)
## checking
data7 <- DF3 %>%
summarise(CoreName_2, mean(c_dens))
## checking
data7 <- DF3 %>%
group_by(CoreName_2) %>%
summarise(Mean_c = mean(c_dens))
## checking
data7 <- DF3 %>%
group_by(CoreName_2) %>%
summarise(Mean_c = mean(c_dens)) %>%
left_join(new_data6)
checking <- ggplot(data7, aes(x = Mean_c, y = c_dens)) +
geom_point()
checking
checking <- ggplot(data7, aes(x = Mean_c, y = c_dens)) +
geom_point() %>%
xlab("Mean C gC / cm^3") %>%
ylab("C density 100 cm")
checking <- ggplot(data7, aes(x = Mean_c, y = c_dens)) +
geom_point() +
xlab("Mean C gC / cm^3") +
ylab("C density 100 cm")
checking
checking_60 <- ggplot(data7, aes(x = Mean_c, y = c_60a)) +
geom_point() +
xlab("Mean C gC / cm^3") +
ylab("C density 60 cm")
checking_60
checking_25 <- ggplot(data7, aes(x = Mean_c, y = c_25a)) +
geom_point() +
xlab("Mean C gC / cm^3") +
ylab("C density 25 cm")
checking_25
checking_100 <- ggplot(data7, aes(x = Mean_c, y = c_dens)) +
geom_point() +
xlab("Mean C gC / cm^3") +
ylab("C density 100 cm")
checking_100
ggsave("100cm.pdf", width = 4, height = 4)
checking_60 <- ggplot(data7, aes(x = Mean_c, y = c_60a)) +
geom_point() +
xlab("Mean C gC / cm^3") +
ylab("C density 60 cm")
checking_60
ggsave("60cm.pdf", width = 4, height = 4)
checking_25 <- ggplot(data7, aes(x = Mean_c, y = c_25a)) +
geom_point() +
xlab("Mean C gC / cm^3") +
ylab("C density 25 cm")
checking_25
ggsave("25cm.pdf", width = 4, height = 4)
